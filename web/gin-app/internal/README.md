# Internal パッケージ

このディレクトリには、アプリケーションの内部実装が含まれています。
Go の `internal` パッケージ規約に従い、このディレクトリ内のコードは外部パッケージからインポートできません。

## ディレクトリ構成

### config/
アプリケーションの設定管理を提供します。

- `config.go`: 環境変数の読み込み、設定の検証

**主な機能:**
- 環境変数からの設定読み込み
- デフォルト値の提供
- 設定のバリデーション

### database/
データベース接続とマイグレーション機能を提供します。

- `database.go`: データベース接続、接続プール設定、自動マイグレーション

**主な機能:**
- GORM を使用したデータベース接続
- 接続プールの管理
- 自動マイグレーション
- ヘルスチェック

### handlers/
HTTPリクエストを処理するハンドラー関数を提供します。

- `user_handler.go`: ユーザー関連のエンドポイント処理
- `product_handler.go`: 商品関連のエンドポイント処理
- `order_handler.go`: 注文関連のエンドポイント処理

**主な機能:**
- リクエストのバリデーション
- ビジネスロジックの実行
- データベース操作
- レスポンスの生成

### middleware/
HTTPリクエストの前処理・後処理を行うミドルウェアを提供します。

- `auth.go`: JWT認証ミドルウェア
- `cors.go`: CORS設定ミドルウェア
- `logger.go`: ロギングミドルウェア
- `rate_limiter.go`: レートリミットミドルウェア

**主な機能:**
- 認証と認可
- クロスオリジンリクエストの処理
- リクエスト/レスポンスのログ記録
- アクセス制限

### models/
データベースモデルとリクエスト/レスポンスの構造体を定義します。

- `user.go`: ユーザーモデル
- `product.go`: 商品モデル
- `order.go`: 注文モデル

**主な機能:**
- データベーステーブルの構造定義
- バリデーションルール
- モデル間のリレーション
- GORM フック

### router/
アプリケーションのルーティング設定を提供します。

- `router.go`: エンドポイントの定義、ミドルウェアの適用

**主な機能:**
- エンドポイントとハンドラーのマッピング
- ミドルウェアの適用
- ルートグループの管理
- 404エラーハンドリング

### utils/
汎用的なユーティリティ関数を提供します。

- `jwt.go`: JWT生成と検証
- `response.go`: レスポンスヘルパー
- `validator.go`: 入力値のバリデーション

**主な機能:**
- JWT トークンの処理
- 標準的なレスポンス形式
- カスタムバリデーション

## 設計方針

1. **単一責任の原則**: 各パッケージは1つの明確な責任を持つ
2. **疎結合**: パッケージ間の依存を最小限に
3. **高凝集**: 関連する機能を同じパッケージに配置
4. **テスタビリティ**: ユニットテストが容易な設計

## インポートルール

- `internal` 配下のパッケージは、同じ `internal` ディレクトリ内からのみインポート可能
- 外部パッケージから `internal` パッケージを直接インポートすることはできない
